{"version":3,"sources":["noData.png","models.js","api/fetch.js","api/rest.js","layout/Error.js","layout/App.js","layout/Page.js","ReleasePage.js","index.js"],"names":["module","exports","__webpack_require__","p","AssetsTable","_ref","item","value","react_default","a","createElement","Fragment","divider","plain","list","size","bordered","dataSource","renderItem","Item","FileZipOutlined","href","url","name","models","Project","resource","type","icon","title","properties","group_name","repo_name","tag_count","tag_name","convertItem","repo","Object","objectSpread","rs","releases","length","lastRs","_","last","latest_tag","permission","view","add","edit","delete","form","filters","submenu","itemActions","_ref4","es_button","onClick","app","go","concat","id","dataTableProps","columns","scroll","x","map","c","key","width","listFields","defaultPageSize","fieldRender","assets","Release","description","field","component","_ref2","input","dist_default","onChange","subfield","preview","draft","items","createTime","format","updateTime","idProp","display","i","readonly","components","DataList","C","lazy","DataForm","props","_use","use","data","schema","model","loading","saveItem","formProps","objectWithoutProperties","xadmin_ui_lib","xadmin_form_lib","assign","formKey","initialValues","onSubmit","_ref5","style","marginTop","height","float","space","Boolean","popconfirm","onConfirm","api","fetch","method","then","_ref3","json","message","success","catch","err","error","releaseDemo","onCancel","okText","cancelText","_ref6","react_markdown_default","source","substring","indexOf","status","statusText","body","options","arguments","undefined","headers","_fetch","response","_step","_iterator","_createForOfIteratorHelper","entries","s","n","done","pair","e","f","text","JSON","parse","store","context","dispatch","payload","headline","content","disabled","license","Promise","reject","API","_this","classCallCheck","this","_super","call","host","getHost","getHeaders","console","Error","hs","Content-Type","uri","_this2","moment","isArray","convert_format","isPlainObject","keys","forEach","k","unitId","rest_createForOfIteratorHelper","_id","filter","encodeURIComponent","stringify","where","parseInt","query","isEmpty","order","ks","_sort","reduce","prev","defineProperty","isNil","skip","_start","limit","_limit","fields","projectFields","allProject","toConsumableArray","level1","level2","allow","index","slice","push","_this3","vs","omit","prve","convert_value","convert_where_value","bind","w","_this4","convert_where_filters","fieldKey","v","cv","property","wheres","_this5","values","_this6","ban","o","isObject","_this7","_len","convert_where","params","Array","_key","queryParams","convert","qs","resolve","join","count","total","convert_item","_this8","_ref7","_this9","partial","_ref8","_ref9","password","_error","convert_data","_ref10","InsertedID","_ref11","RESTBaseAPI","Paragraph","Typography","Text","onClose","card","es_result","subTitle","extra","window","location","reload","className","strong","fontSize","color","toString","Sider","Layout","AppError","Menu","SubMenu","state","info","setState","children","layout_Error","React","Component","IsAuthenticated","pathname","_React$useState","user","useState","_React$useState2","slicedToArray","collapseds","setCollapseds","_React$useState3","_React$useState4","useEffect","coll","localStorage","getItem","layout","minHeight","overflow","collapsible","collapsedWidth","collapsed","onCollapse","setItem","webkitAppRegion","_c","menu","mode","theme","selectedKeys","overflowY","App_AppError","ReleasePage","repoId","setSchema","get","group","xadmin_model_lib","modelKey","is","i18n","ui","actions","relate","modalform","search","reldetail","splashscreen","config","router","locale","lng","auth","can_signin","can_signup","can_reset_password","persist_type","date_format","time","date","datetime","textDefaultSearch","submenuShowAllFilter","routers","/app/","path","logger","level","start","container"],"mappings":"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","file":"static/js/main.e2920cf9.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/noData.70b83dfe.png\";","import React from 'react'\nimport _ from 'lodash'\nimport { Button, Space, Divider, List, Card, Popconfirm, message } from 'antd'\nimport { FileZipOutlined } from '@ant-design/icons'\n\nimport { C, Loading } from 'xadmin-ui'\nimport { SchemaForm } from 'xadmin-form'\nimport { use, app, api } from 'xadmin'\n\nimport ReactMarkdown from 'react-markdown'\nimport MarkdownEditor from 'for-editor'\n\nconst AssetsTable = ({ item, value }) => {\n  return (\n    <>\n      <Divider plain={true}>附件</Divider>\n      <List\n        size=\"small\"\n        bordered\n        dataSource={value}\n        renderItem={item => <List.Item><FileZipOutlined /> <a href={item.url}>{item.name}</a></List.Item>}\n      />\n    </>\n  )\n}\n\nconst MarkdownField = ({ input }) => {\n  return <MarkdownEditor value={input.value} onChange={input.onChange} subfield={true} preview={true} />\n}\n\nconst ModelForm = props => {\n  const { data, title, schema, model, loading, saveItem, ...formProps } = use('model.item', props)\n  return loading ? <Loading /> : \n    (<SchemaForm \n      formKey={`model.${model.key}`}\n      schema={schema || model}\n      initialValues={data}\n      onSubmit={(item) => saveItem({\n        id: item.tag_name,\n        description: item.description,\n        draft: item.draft,\n        assets: item.assets\n      })}\n      {...formProps}\n      {...model.formProps} />\n    )\n}\n\nconst releaseDemo = item => {\n  const { group_name, repo_name, tag_name } = item\n\n  api({ name: `release/${group_name}/${repo_name}/${tag_name}/accept` })\n    .fetch('', {\n      method: 'PUT'\n    })\n    .then(({json}) => {\n      message.success('发布成功')\n    })\n    .catch(err=> { message.error(err.message) })\n}\n\nexport default {\n  Project: {\n    name: 'Project',\n    resource: 'repos',\n    type: 'object',\n    icon: 'user',\n    title: '项目',\n    properties: {\n      group_name: { type: 'string' },\n      repo_name: { type: 'string' },\n      tag_count: { type: 'number' },\n      tag_name: { type: 'string' }\n    },\n    convertItem: item => {\n      const repo = { ...item }\n      const rs = item.releases\n      repo.tag_count = rs.length\n      const lastRs = _.last(rs)\n      if(lastRs) {\n        repo.latest_tag = lastRs.tag_name\n      }\n      return repo\n    },\n    permission: { view: true, add: false, edit: false, delete: true },\n    form: [ 'group_name', 'repo_name' ],\n    filters: {\n      submenu: [ 'group_name', 'repo_name' ]\n    },\n    itemActions: [ \n      ({ item }) => { return <Button onClick={() => app.go(`/app/repos/${item.id}/releases`)}>查看详情</Button> }\n    ],\n    dataTableProps: (columns) => ({\n      scroll: { x: 1500 },\n      columns: columns.map(c => c.key === '__action__' ? { ...c, width: 200 } : c )\n    }),\n    // required: [ 'summaries' ],\n    listFields: [ 'group_name', 'repo_name', 'tag_count', 'latest_tag' ],\n    defaultPageSize: 20,\n    fieldRender: {\n      assets: AssetsTable\n    }\n  },\n  Release: {\n    name: 'Releases',\n    resource: 'releases',\n    type: 'object',\n    title: '所有版本',\n    properties: {\n      group_name: { type: 'string' },\n      repo_name: { type: 'string' },\n      tag_name: { type: 'string' },\n      description: { type: 'string', field: {\n        component: MarkdownField\n      } },\n      draft: { type: 'boolean' },\n      assets: { \n        type: 'array', \n        items: { \n          type: 'object',\n          properties: {\n            id: { type: 'string' },\n            name: { type: 'string' },\n            url: { type: 'string' },\n          }\n        } \n      },\n      createTime: { type: 'string', format: 'datetime' },\n      updateTime: { type: 'string', format: 'datetime' }\n    },\n    idProp: 'tag_name',\n    permission: { view: true, add: false, edit: true, delete: true },\n    form: [ 'group_name', 'repo_name', 'tag_name', 'description', 'draft', 'assets' ],\n    filters: {\n      // submenu: { fields: [ 'releases' ], submitOnChange: true },\n    },\n    display: (i) => `${i.group_name}/${i.repo_name} ${i.tag_name}`,\n    readonly: [ 'group_name', 'repo_name', 'tag_name' ],\n    listFields: [ 'tag_name', 'createTime', 'description', 'assets' ],\n    components: {\n      DataList: C.lazy('Model.DataList'),\n      DataForm: ModelForm\n    },\n    itemActions: [],\n    fieldRender: {\n      tag_name: ({ item, value }) => (\n        <div style={{ marginTop: 20, height: 40 }}>\n          <h2 style={{ float: 'left'}}>{value}</h2>\n          <Space style={{float: 'right'}}>\n            {Boolean(item.draft) ? <Popconfirm title=\"确定发布吗?\" onConfirm={()=> releaseDemo(item)} onCancel={()=>{}} okText=\"确定\" cancelText=\"取消\">\n              <Button type=\"primary\">草稿</Button>\n            </Popconfirm>\n             : <Button type=\"dashed\">已发布</Button>}\n            {/* <Button onClick={() => app.go(`/app/model/release/${item.id}/edit`)}>编辑</Button>\n            <C is=\"Model.ActionDelete\" size=\"middle\" /> */}\n          </Space>\n        </div>\n      ),\n      description: ({ value }) => <ReactMarkdown source={value && value.substring(value.indexOf('\\n\\n\\n'))} />,\n      assets: AssetsTable\n    }\n  }\n}\n","import _fetch from 'isomorphic-fetch'\nimport { app } from 'xadmin'\nimport _ from 'lodash'\n\nconst fetch = (url, options = {}) => {\n  let status, statusText, headers = {}, body, json\n  return _fetch(url, options)\n    .then(response => {\n      for (let pair of response.headers.entries()) {\n        headers[pair[0]] = pair[1]\n      }\n      status = response.status\n      statusText = response.statusText\n      return response\n    })\n    .then(response => response.text())\n    .then(text => {\n      body = text\n      try {\n        json = JSON.parse(text)\n      } catch (e) {\n        // not json, no big deal\n      }\n\n      const store = app.context.store\n      if (status == 401) {\n        // 未登录\n        store.dispatch({ type: '@@xadmin/AUTH_SIGN_OUT_FINISH' })\n      } else if (status == 403) {\n        // 无权限访问\n        store.dispatch({\n          type: '@@xadmin/ADD_NOTICE', payload: {\n            type: 'danger',\n            headline: '访问被拒绝',\n            message: {\n              key: '您没有权限进行该操作',\n              content: '您没有权限进行该操作'\n            }\n          }\n        })\n      }\n\n\n      if (status < 200 || status >= 300) {\n        let message = body || statusText\n        if (json && json.error && json.error.message) {\n          message = json.error.message\n        }\n        if (json && json.disabled) {\n          // 用户禁用\n          store.dispatch({\n            type: '@@xadmin/ADD_NOTICE', payload: {\n              type: 'danger', headline: '访问被拒绝', message: json.disabled\n            }\n          })\n        }\n\n        if (status >= 500) {\n          const { store } = app.context\n          // 服务器错误，弹出错误提示\n          store.dispatch({\n            type: '@@xadmin/ADD_NOTICE', payload: {\n              type: 'danger', headline: '服务器出错了', message: '服务器出现了错误，请联系系统管理员。'\n            }\n          })\n        }\n        if (status == 406) {\n          app.go('/nolicense')\n        }\n\n        if (json && json.license) {\n          // 授权错误，统一报错\n          const { store } = app.context\n          store.dispatch({\n            type: '@@xadmin/ADD_NOTICE', payload: {\n              type: 'danger', headline: '请您更新授权', message: '请您更新授权:' + json.license\n            }\n          })\n          message = json.license\n        }\n        return Promise.reject({ message, status, headers, json })\n      }\n      \n      return { status, headers, body, json }\n    })\n}\n\nexport default fetch\n","import _, { reject } from 'lodash'\nimport app from 'xadmin'\nimport moment from 'moment'\nimport { RESTBaseAPI } from 'xadmin'\nimport fetch from './fetch'\n\nexport default class API extends RESTBaseAPI {\n\n  constructor(options) {\n    super(options)\n    this.model = options\n    this.host = this.getHost()\n    this.headers = this.getHeaders()\n    // console.log(this.resource)\n    if (this.resource == undefined) {\n      console.error(options)\n      throw Error('resource is undefind')\n    }\n  }\n\n  getHost() {\n    return 'http://air.tmis.top:1337/'\n  }\n\n  getHeaders() {\n    const hs = {\n      'Content-Type': 'application/json'\n    }\n    hs['Authorization'] = 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjEyNDIwOTM5LCJleHAiOjE2MTUwMTI5Mzl9.-eh6_7XpATCa5uONKkc-x8XWA4xNRCDvpGHLM4b26xs'\n    return hs\n  }\n\n  fetch(uri, options) {\n    return fetch(this.getHost() + this.resource + uri, {\n      headers: this.getHeaders(), ...options\n    })\n  }\n\n  convert_format(value, schema) {\n    if(schema.format == 'datetime') {\n      return moment(value).format('YYYY-MM-DD HH:mm:ss')\n    } else if(schema.format == 'date') {\n        return moment(value).format('YYYY-MM-DD')\n    } else if(schema.type == 'array' && _.isArray(value)) {\n      return value.map(i => this.convert_format(i, schema.items))\n    } else if(schema.type == 'object' && _.isPlainObject(value)) {\n      Object.keys(schema.properties).forEach(k => {\n        const p = schema.properties[k]\n        value[k] = this.convert_format(value[k], p)\n      })\n    }\n    return value\n  }\n\n  convert_item(item, method = 'query') {\n\n    //有的请求数据没有ID，需要用几个属性做联合ID\n    if (this.model.idProp) {\n      if ((typeof this.model.idProp) == 'object') {\n        let unitId = ''\n        for (let i of this.model.idProp) {\n          unitId += item[i];\n        }\n        item = { ...item, id: unitId }\n      }\n      else {\n        item = { ...item, id: item[this.model.idProp] }\n      }\n    } else if (item._id) {\n      item.id = item._id\n    }\n    if (this.model.convertItem) {\n      item = this.model.convertItem(item)\n    }\n    \n    item = this.convert_format(item, this.model)\n    return item\n  }\n\n  count(filter = {}) {\n    let filter_string = encodeURIComponent(JSON.stringify({ where: filter['where'] || {} }))\n    return this.fetch(`/count?`).then(({ body }) => {\n      return parseInt(body)\n    })\n  }\n\n  convert(f) {\n    const query = {}\n\n    if (!_.isEmpty(f.order)) {\n      let ks = Object.keys(f.order)\n        .filter(k => f.order[k] == 'ASC' || f.order[k] == 'DESC')\n      if (ks.length > 0)\n        query._sort = ks.reduce((prev, key) => ({ ...prev, [key]: f.order[key] == 'ASC' ? 1 : -1 }), {})\n    }\n\n    if (!_.isNil(f.skip)) {\n      query._start = parseInt(f.skip)\n    }\n    if (!_.isNil(f.limit)) {\n      query._limit = parseInt(f.limit)\n    }\n\n    if (!_.isEmpty(f.fields) || this.model.projectFields) {\n      const allProject = [...(this.model.projectFields || []), ...(f.fields || [])]\n      const level1 = allProject && allProject.filter(k => k.indexOf('.') == -1)\n      const level2 = allProject && allProject.filter(k => k.indexOf('.') > 0)\n      const allow = []\n      level2.forEach((item, index) => {\n        const p = item.slice(0, item.indexOf('.'))\n        // 如果是外键不作处理\n        if (p == 'model' || p == 'department' || p == 'node') {\n          allow.push(level2[index])\n        } else {\n          if (level1.indexOf(p) == -1) allow.push(item)\n        }\n      })\n\n      //query.project = [...level1, ...allow,].reduce((prev, f) => ({ ...prev, [f]: 1 }), {})\n    }\n    return query\n  }\n\n  convert_value(value) {\n    if (_.isPlainObject(value)) {\n      // 适配公司查询\n      if (value.id) {\n        return value.id\n      }\n\n      let vs = _.omit(value, 'rule')\n\n      return Object.keys(vs).reduce((prve, key) => {\n        prve[key] = this.convert_value(vs[key])\n        return prve\n      }, {})\n\n    } else if (_.isArray(value)) {\n      return value.map(this.convert_where_value.bind(this))\n    } else {\n      return value\n    }\n  }\n\n  convert_where_value(w) {\n    const where = this.convert_where_filters(w)\n    return _.isPlainObject(where) ? Object.keys(where).reduce((prev, key) => {\n      // 关联数据加上Id\n      let fieldKey = key\n      const v = this.convert_value(where[key])\n      const cv = this.convert_where_filters(v)\n      if (_.isPlainObject(cv) && Object.keys(cv).length > 0 && Object.keys(cv)[0].indexOf('$') != 0) {\n        prev = Object.keys(cv).reduce((p, k) => {\n          if (k == 'gte' || k == 'lte') {\n            p[fieldKey] = { ...p[fieldKey], [k]: cv[k] }\n          } else {\n            p[`${fieldKey}.${k}`] = cv[k]\n          }\n          return p\n        }, prev)\n      } else {\n        const property = this.model.properties ? this.model.properties[fieldKey] : null\n        if (property && (property.type == 'object' || property.type == 'array')) {\n          fieldKey = fieldKey + 'Id'\n        }\n        prev[fieldKey] = cv\n      }\n      return prev\n    }, {}) : where\n  }\n\n  convert_where(wheres) {\n    let where = _.values(wheres).map(w => this.convert_where_value(w))\n    if (where.length > 0) {\n      if (where.length > 1) {\n        where = where.reduce((p, w) => ({ ...p, ...w }), {})\n      } else {\n        where = where[0]\n      }\n    } else {\n      where = {}\n    }\n    return where\n  }\n\n  convert_where_filters(v) {\n    if (!_.isPlainObject(v)) return v\n    const ban = ['like', 'eq', 'gt', 'gte', 'in', 'inq', 'lt', 'lte', 'ne', 'nin', 'and', 'not', 'nor', 'or']\n    const cv = Object.keys(v).map(item => {\n      const o = v[item]\n      if (_.isObject(o)) {\n        let k = item\n        if (ban.indexOf(item) >= 0 && item.indexOf('$') == -1) {\n          k = [`$${item}`]\n        }\n        return { [k]: this.convert_where_filters(o) }\n      } else {\n        if (ban.indexOf(item) >= 0 && item.indexOf('$') == -1) {\n          return { [`$${item == 'like' ? 'regex' : item}`]: o }\n        } else {\n          return { [item]: o }\n        }\n      }\n    }).reduce((p, c) => ({ ...p, ...c }), {})\n    return cv\n  }\n\n  query(filter = {}, wheres = {}, withCount = true, ...params) {\n    const where = this.convert_where(wheres)\n    const f = { ...params, ...this.model.queryParams, ...this.convert(filter) }\n    let qs = []\n    Object.keys(f).forEach(key => {\n      qs.push(`${key}=${encodeURIComponent(f[key])}`)\n    })\n\n    return new Promise((resolve, reject) => {\n      this.fetch(`?${qs.join('&')}`).then(({ json, headers }) => {\n        this.count().then(total => {\n          resolve({ items: json.map(this.convert_item.bind(this)), total })\n        }).catch(reject)\n      }).catch(reject)\n    })\n  }\n\n  get(id = '') {\n    return this.fetch(`/${id}`).then(({ json }) => {\n      if (this.resource == 'core/user') {\n        json = _.omit(json, 'password', 'password2')\n      }\n      return this.convert_item({ ...json, id })\n    })\n  }\n\n  getOrigin(id = '') {\n    return this.fetch(`/${id}`)\n  }\n\n  delete(id = '') {\n    return this.fetch(`/${id}`, { method: 'DELETE' }).then(({ json }) => ({ ...json, id }))\n  }\n\n  convert_data(data) {\n    // Object.keys(data).forEach(key => {\n    //   if (_.isPlainObject(data[key]) && data[key].id !== undefined) {\n    //     data[key + '_id'] = data[key].id\n    //   }\n    // })\n    return _.omit(data, ['__partial__'])\n  }\n\n  save(data = {}, partial = false) {\n    if (this.resource == 'core/auth/logout') {\n      return new Promise((resolve, reject) => resolve({}))\n    }\n\n    if (this.resource == 'core/auth/login') {\n      return new Promise((resolve, reject) => {\n        this.fetch('', {\n          method: 'POST',\n          body: JSON.stringify(data)\n        })\n          .then(({ json }) => resolve(json))\n          .catch(({ json }) => reject({ json: { password: json ? json._error : '登录出现错误请联系系统管理员' } }))\n      })\n    }\n\n    if (data.id) {\n      return this.fetch(`/${data.id}`, {\n        method: !partial ? 'PUT' : 'PATCH',\n        body: JSON.stringify(this.convert_data(_.omit(data, 'id')))\n      }).then(({ json }) => ({\n        ...data,\n        InsertedID: json.InsertedID\n      }))\n    } else {\n      return this.fetch('', {\n        method: 'POST',\n        body: JSON.stringify(this.convert_data(data))\n      }).then(({ json }) => ({\n        ...data,\n        id: json.InsertedID\n      }))\n    }\n\n  }\n\n}\n\nexport { fetch }\n","import React from 'react'\nimport { Card, Typography, Button, Result } from 'antd'\nimport { Icon } from 'xadmin-ui'\nconst { Paragraph, Text } = Typography;\n\nconst Error = ({ error, onClose }) => {\n  return (\n    <Card>\n      <Result\n        status=\"error\"\n        title=\"对不起，页面运行发生了错误！\"\n        subTitle=\"在页面运行中出现了错误，导致页面无法正常显示，这可能是系统配置不正确导致的，请联系您的系统管理员帮您解决.\"\n        extra={[\n          <Button type=\"primary\" key=\"home\" onClick={()=> window.location = '/'}>\n            回到首页\n          </Button>,\n          <Button key=\"refresh\" onClick={()=> window.location.reload()}>刷新页面</Button>,\n          <Button key=\"close\" onClick={onClose}>关闭错误信息</Button>\n        ]}\n      >\n        <div className=\"desc\">\n          <Paragraph>\n            <Text\n              strong\n              style={{\n                fontSize: 14,\n              }}\n            >\n              如果您是开发人员，可查看如下错误详情:\n            </Text>\n          </Paragraph>\n          <Paragraph>\n            <Icon style={{ color: 'red' }} type=\"close-circle\" />{' '}\n            {error.toString()}\n          </Paragraph>\n        </div>\n      </Result>\n    </Card>\n  )\n}\n\nexport default Error\n","import { Layout, Menu, Card, Result } from 'antd'\nimport React from 'react'\nimport { use, config as _c, Block, app, api } from 'xadmin'\nimport { Icon, Page } from 'xadmin-ui';\n\nimport Error from './Error'\nimport { IsAuthenticated, HasPermission } from 'xadmin-auth'\n// import MainMenu from '../../components/MainMenu'\nconst { Sider } = Layout\n\nconst { SubMenu } = Menu\n\nconst ProtectError = ({ error, onClose }) => {\n  return (\n    <Card>\n      <Result\n        status=\"error\"\n        title=\"您没有查看该页面权限\"\n      >\n      </Result>\n    </Card>\n  )\n}\n\nclass AppError extends React.Component {\n\n  state = {\n    error: null\n  }\n\n  componentDidCatch(error, info) {\n    this.setState({ error })\n  }\n\n  render() {\n    const { error } = this.state\n    let children = this.props.children\n    if (error) {\n      children = <Page title=\"系统错误\"><Error error={error} onClose={() => this.setState({ error: null })} /></Page>\n    }\n    return children\n  }\n\n}\n\nconst App = IsAuthenticated(props => {\n  const pathname = props.location.pathname\n  const { user } = use('redux', state => ({ user: state.user }))\n  const [collapseds, setCollapseds] = React.useState(true)\n  const [selectedKeys, setSelectedKeys] = React.useState([])\n\n  const onCollapse = (coll) => {\n    setCollapseds(coll)\n    localStorage.setItem('Menu_collapsed', coll)\n  }\n\n  React.useEffect(() => {\n    const coll = localStorage.getItem('Menu_collapsed')\n    setCollapseds(coll === \"false\" ? false : true)\n  }, [])\n\n\n  // return (user.protectUrl && user.protectUrl != pathname) ? <ProtectError /> :\n  return (\n    <Layout className=\"layoutnamedsfsf\" style={{ minHeight: '100vh', overflow: 'auto' }}>\n      <Sider\n        collapsible\n        collapsedWidth={80}\n        collapsed={collapseds}\n        onCollapse={onCollapse}\n        style={!collapseds ? { minHeight: 300, height: 'calc(100vh - 48px)', overflow: 'auto' } : { minHeight: 300 }}>\n\n        <div className=\"logo\" style={{ 'webkitAppRegion': 'drag' }}>\n          {_c('site.logo')}\n          {_c('site.title')}\n        </div>\n\n        <Menu\n          mode={props.mode}\n          theme=\"dark\"\n          // onClick={onClick}\n          selectedKeys={pathname}\n          style={{ overflowY: 'scroll', overflowY: 'overlay' }}\n        >\n          <Menu.Item key='/app/model/Project/list' >\n            <a onClick={() => app.go('/app/model/Project/list')}>\n              <Icon className=\"nav-icon\" type=\"setting\" />\n              <span className=\"nav-text\">项目</span>\n            </a>\n          </Menu.Item>\n        </Menu>\n\n        {/* <Block name=\"top.right\" >\n          {items => <Menu selectedKeys={pathname}\n            style={collapseds ? { marginBottom: 20, position: 'absolute', bottom: 30, left: 0 }\n              : {}} theme=\"dark\" >\n            <Menu.Item key='/app/settings' >\n              <a onClick={() => app.go('/app/settings')}>\n                <Icon className=\"nav-icon\" type=\"setting\" />\n                <span className=\"nav-text\">系统设置</span>\n              </a>\n            </Menu.Item>\n            {items}\n          </Menu>}\n        </Block> */}\n      </Sider>\n      <div className=\"main-content\" style={{ overflow: 'auto', width: '100%' }}>\n        <AppError>{props.children}</AppError>\n      </div>\n    </Layout >\n  )\n})\n\nexport default App\n","import { PageHeader } from 'antd'\nimport { Layout, Menu } from 'antd'\nimport React from 'react'\nimport SplitPane from 'react-split-pane'\n\nclass Page extends React.Component {\n  render() {\n    const { title, subTitle, content, sider, breadcrumb, extra, actions, tabs, footer, className, style, children, ...pageProps } = this.props\n    const page = (\n      <Layout className={className ? className : 'xadmin-model-list'} style={{ ...style, height: '100vh' }}>\n        <PageHeader\n          title={title}\n          subTitle={subTitle}\n          extra={actions}\n          tabs={tabs}\n          breadcrumb={breadcrumb}\n          footer={footer}\n          {...pageProps}\n          style={{ zIndex: 1, position: 'sticky', 'webkitAppRegion': 'drag', borderBottom: '1px solid #f0f0f0' }}\n        >\n          {(content || extra) ? (\n            <>\n              {content && <div className=\"content padding\">{content}</div>}\n              {extra && <div className=\"extraContent\">{extra}</div>}\n            </>\n          ) : null}\n        </PageHeader>\n        <div style={{ overflowY: 'auto', overflowX: 'hidden', padding: 10 }}>\n          {children}\n        </div>\n      </Layout>\n    )\n    return sider ? (\n      <SplitPane pane2Style={{ width: 0 }} style={{ height: '100vh', position: 'relative' }} split=\"vertical\" defaultSize={240} maxSize={400} minSize={150}>\n        {sider}{page}\n      </SplitPane>\n    ) : page\n  }\n}\n\nexport default Page\n","import React from 'react';\nimport { Model } from 'xadmin-model'\nimport { C, Loading } from 'xadmin-ui'\nimport { use, app, api } from 'xadmin'\n\nconst ReleasePage = props => {\n  const { params: { repoId } } = props\n  const [ schema, setSchema ] = React.useState(null) \n\n  React.useEffect(() => {\n    api({resource: 'repos'}).get(repoId)\n      .then(({ group_name: group, repo_name: repo }) => {\n        setSchema({\n          ...app.get('models').Release,\n          resource: `releases`,\n          queryParams: { repo: repoId },\n          name: `Release_${group}_${repo}`,\n          title: `版本 ${group}:${repo}`\n        })\n      })\n  }, [ repoId ])\n\n  return schema ? <Model modelKey={schema.name} schema={schema}><C is='Model.ListPage' /></Model> : null\n}\n\nexport default ReleasePage\n","import React from 'react'\nimport './index.css';\nimport app from 'xadmin';\n\nimport i18n from 'xadmin-i18n'\nimport auth from 'xadmin-auth'\nimport form from 'xadmin-form'\nimport ui, { C } from 'xadmin-ui'\nimport model from 'xadmin-model'\nimport relate from 'xadmin-model/lib/relate'\nimport filter from 'xadmin-model/lib/filter'\nimport actions from 'xadmin-model/lib/actions'\n\nimport loading from 'xadmin-ui/lib/loading'\nimport splashscreen from 'xadmin-ui/lib/splashscreen'\n\nimport modalform from 'xadmin-model/lib/modalform'\nimport search from 'xadmin-model/lib/search'\nimport reldetail from 'xadmin-model/lib/reldetail'\n\nimport components from 'xadmin-antd'\n//import components from 'xadmin-bootstrap'\n\nimport models from './models'\n// import themes from './themes'\nimport api from './api/rest'\nimport layout from './layout'\n\nimport 'moment/locale/zh-cn' \nimport 'antd/dist/antd.min.css'\n\nimport ReleasePage from './ReleasePage'\n\napp\n.use(i18n)\n.use(ui)\n.use(loading)\n.use(form)\n//.use(themes)\n.use(model)\n.use(filter)\n.use(actions)\n.use(relate)\n//.use(auth)\n.use(modalform)\n.use(search)\n.use(reldetail)\n.use(components)\n.use(splashscreen)\n//.use(layout)\n.use({\n  config: {\n    api,\n    router: 'hash',\n    locale: {\n      lng: 'zh_Hans', moment: 'zh-cn'\n    },\n    auth: { can_signin: true, can_signup: true, can_reset_password: true, persist_type: 'session-storage' },\n    date_format: {\n      time: 'HH:mm:ss', date: 'YYYY-MM-DD', datetime: 'YYYY-MM-DD HH:mm:ss'\n    },\n    filter: {\n      textDefaultSearch: true,\n      submenuShowAllFilter: true\n    }\n  },\n  // components: {\n  //   Dashboard: () => \"Air IOT cloud\"\n  // },\n  routers: {\n    '/app/': [\n      {\n        path: 'repos/:repoId/releases',\n        component: ReleasePage\n      }\n    ]\n  },\n  models,\n  logger: app => (level, message, err) => {\n    if(level == 'error') {\n      console.error(err)\n    }\n  },\n}).start({ container: '#root' })\n"],"sourceRoot":""}